<div class="bcp-layout-container">
  <!-- Headers -->
  <app-header class="bcp-header-desktop"></app-header>
  <app-header class="bcp-header-mobile"></app-header>
  <!-- Contenedor principal con scroll -->
  <div class="bcp-content-container">
    <div class="flex flex-col lg:flex-row bg-gray-100  flex-1 w-full">
      <!-- Imagen izquierda -->
      <div class="lg:w-2/5 w-full h-full flex-shrink-0  hidden lg:block">
        <div class="h-full w-lg rounded-3xl overflow-hidden">
          <svg class="w-full h-full block" width="500" height="600" viewBox="0 0 594 841" fill="none"
            xmlns="http://www.w3.org/2000/svg">
            <path
              d="M40.9403 -172.423C-364.383 35.6566 -360.908 409.063 -326 605.119C25.8312 38.7429 398.915 234.871 459.264 272.898C571.848 340.761 721.602 421.071 853.065 301.075C1125.5 19.356 541.032 -429.154 40.9403 -172.423Z"
              fill="url(#paint0_linear_336_643)" />
            <path
              d="M239.654 234.655C414.931 -91.6035 737.14 -59.6429 876.335 -2.88037C521.659 -501.813 -222.114 -237.162 -324.357 248.755C-429.566 748.772 -81.5284 958.559 -57.6664 974.829C93.098 1069.19 351.372 801.919 264.601 691.287C177.83 580.654 157.222 389.758 239.654 234.655Z"
              fill="url(#paint1_linear_336_643)" />
            <path
              d="M3.83295 1031.86C-390.34 803.356 -371.409 398.343 -325.636 248.786C-143.971 859.118 382.134 643.367 444.345 608.47C560.247 546.443 713.905 473.883 839.071 600.433C1096.77 895.693 490.167 1313.78 3.83295 1031.86Z"
              fill="url(#paint2_linear_336_643)" />
            <defs>
              <linearGradient id="paint0_linear_336_643" x1="702.138" y1="197.07" x2="654.571" y2="-57.7274"
                gradientUnits="userSpaceOnUse">
                <stop stop-color="#34B1CF" />
                <stop offset="1" stop-color="#153F7B" />
              </linearGradient>
              <linearGradient id="paint1_linear_336_643" x1="479.281" y1="1123.32" x2="1641.39" y2="-105.078"
                gradientUnits="userSpaceOnUse">
                <stop stop-color="#002B76" />
                <stop offset="1" stop-color="#34B1CF" />
              </linearGradient>
              <linearGradient id="paint2_linear_336_643" x1="371.821" y1="274.871" x2="485.541" y2="889.861"
                gradientUnits="userSpaceOnUse">
                <stop stop-color="#002B76" />
                <stop offset="0.808385" stop-color="#34B1CF" />
              </linearGradient>
            </defs>
          </svg>
        </div>

      </div>

      <!-- Contenido principal -->
      <div class="flex flex-col lg:flex-row bg-white flex-1 w-full max-h-screen overflow-auto rounded-3xl">
        <div class="h-[80vh] lg:h-auto lg:flex-1 max-w-lg mx-auto bg-white rounded-3xl p-6 my-auto">
          <div class="w-full p-6 flex flex-col h-full">
            <!-- Título -->
            <h2 class="text-xl text-center font-semibold text-gray-800 mb-2 title-alias-1">Ingresa tu contraseña</h2>

            <form name="form" class="space-y-6" #f="ngForm" novalidate autocomplete="off">
              <!-- Selector de tipo de autenticación -->
              <div class="flex bg-gray-100 rounded-lg p-1 mb-1">
                <button type="button" class="flex-1 py-2 px-4 text-sm font-medium rounded-md transition-colors"
                  [ngClass]="!changePassword.isAlias ? 'bg-[#153F7B] text-white shadow-sm' : 'text-gray-600 hover:text-gray-800'"
                  (click)="selectAuth(false)">
                  Número de acceso
                </button>
                <button type="button" class="flex-1 py-2 px-4 text-sm font-medium rounded-md transition-colors"
                  [ngClass]="changePassword.isAlias ? 'bg-[#153F7B] text-white shadow-sm' : 'text-gray-600 hover:text-gray-800'"
                  (click)="selectAuth(true)">
                  Alias
                </button>
              </div>

              <!-- Campo de acceso o alias -->
              <div class="mb-2">
                <ng-container *ngIf="!isAlias">
                  <label class="block text-sm title-text-change-pass my-3">Número de acceso:</label>
                  <input name="AccessNumber"
                    class="block w-full px-2 py-2 rounded-lg border border-gray-300 bg-gray-50 text-gray-800 placeholder-gray-500 focus:ring-2 focus:ring-blue-500 focus:border-transparent focus:bg-white transition-colors"
                    type="text" [(ngModel)]="changePassword.accessNumber" appOnlyNumber [appMaxLength]="16" required
                    autofocus placeholder="900001001494I740" />
                </ng-container>
                <ng-container *ngIf="isAlias">
                  <label class="block text-sm title-text-change-pass my-3">Alias:</label>
                  <input name="AccessNumber"
                    class="block w-full px-2 py-2 rounded-lg border border-gray-300 bg-gray-50 text-gray-800 placeholder-gray-500 focus:ring-2 focus:ring-blue-500 focus:border-transparent focus:bg-white transition-colors"
                    type="text" [(ngModel)]="changePassword.userAlias" [minlength]="8" [appMaxLength]="16" required
                    autofocus appOnlyType="alphanumericBasicSymbolsLogin" appValidate="alphanumericBasicSymbolsLogin"
                    placeholder="Ingresa tu alias" />
                </ng-container>
              </div>

              <!-- Contraseña actual -->
              <div class="mb-2">
                <label class="block text-sm title-text-change-pass my-3">Ingrese su contraseña actual:</label>
                <div class="relative">
                  <input name="oldPassword"
                    class="block w-full px-2 py-2 pr-12 rounded-lg border border-gray-300 bg-gray-50 text-gray-800 placeholder-gray-500 focus:ring-2 focus:ring-blue-500 focus:border-transparent focus:bg-white transition-colors"
                    required type="{{ visiblePass ? 'text' : 'password' }}" [(ngModel)]="changePassword.oldPassword"
                    #txtOldPassword [appMaxLength]="20" appOnlyType="alphanumericBasicSymbolsLogin"
                    appValidate="password" placeholder="Ingrese su contraseña actual" />

                  <!-- Contenedor clicable para el SVG -->
                  <button type="button" (click)="showHidePassword()"
                    class="absolute right-3 top-1/2 transform -translate-y-1/2 focus:outline-none cursor-pointer">
                    <img *ngIf="!visiblePass" src="assets/svgs/eye_close.svg" alt="Mostrar contraseña" class="w-6 h-6">
                    <img *ngIf="visiblePass" src="assets/svgs/eye_open.svg" alt="Ocultar contraseña" class="w-6 h-6">
                  </button>
                </div>

              </div>

              <!-- Mensaje informativo -->
              <div class="bg-blue-50 border-l-4 border-blue-400 p-4 mb-2">
                <div class="flex">
                  <div class="flex-shrink-0">
                    <em class="fas fa-info-circle text-blue-400"></em>
                  </div>
                  <div class="ml-3">
                    <p class="text-alias-1">
                      La contraseña debe tener: 2 Mayúsculas, 2 Minúsculas. Entre 8-14
                      caracteres, SOLO números y letras, NO caracteres especiales.
                    </p>
                  </div>
                </div>
              </div>

              <!-- Nueva contraseña -->
              <div class="mb-2">
                <label class="block text-sm title-text-change-pass my-3">Ingrese su nueva contraseña:</label>
                <div class="relative">
                  <input name="newPassword"
                    class="block w-full px-2 py-2 pr-12 rounded-lg border border-gray-300 bg-gray-50 text-gray-800 placeholder-gray-500 focus:ring-2 focus:ring-blue-500 focus:border-transparent focus:bg-white transition-colors"
                    required type="{{ visibleNewPass ? 'text' : 'password' }}" [(ngModel)]="changePassword.newPassword"
                    validateEqual="confirmPassword" reverse="true" #txtNewPassword #txtNewPassword2="ngModel"
                    (ngModelChange)="onPasswordsChange()"
                    appValidate="password" minlength="7" maxlength="20" appOnlyType="alphanumericBasicSymbolsLogin"
                    placeholder="Ingresa tu nueva contraseña" />
                  <button type="button" (click)="showHideNewPassword()"
                    class="absolute right-3 top-1/2 transform -translate-y-1/2 focus:outline-none cursor-pointer">
                    <img *ngIf="!visibleNewPass" src="assets/svgs/eye_close.svg" alt="Mostrar contraseña"
                      class="w-6 h-6">
                    <img *ngIf="visibleNewPass" src="assets/svgs/eye_open.svg" alt="Ocultar contraseña" class="w-6 h-6">
                  </button>
                </div>
              </div>

              <!-- Confirmar nueva contraseña -->
              <div class="mb-2">
                <label class="block text-sm title-text-change-pass my-3">Confirme su nueva contraseña:</label>
                <div class="relative">
                  <input name="confirmPassword"
                    class="block w-full px-2 py-2 pr-12 rounded-lg border border-gray-300 bg-gray-50 text-gray-800 placeholder-gray-500 focus:ring-2 focus:ring-blue-500 focus:border-transparent focus:bg-white transition-colors"
                    required #confirmPassword="ngModel" type="{{ visibleConfirmPass ? 'text' : 'password' }}"
                    [(ngModel)]="changePassword.confirmPassword" validateEqual="newPassword" #txtConfirmPassword
                    (ngModelChange)="onPasswordsChange()"
                    minlength="7" maxlength="20" appOnlyType="alphanumericBasicSymbolsLogin" appValidate="password"
                    placeholder="Vuelva a ingresar su nueva contraseña" />
                  <button type="button" (click)="showHideConfirmPassword()"
                    class="absolute right-3 top-1/2 transform -translate-y-1/2 focus:outline-none cursor-pointer">
                    <img *ngIf="!visibleConfirmPass" src="assets/svgs/eye_close.svg" alt="Mostrar contraseña"
                      class="w-6 h-6">
                    <img *ngIf="visibleConfirmPass" src="assets/svgs/eye_open.svg" alt="Ocultar contraseña"
                      class="w-6 h-6">
                  </button>
                </div>
              </div>

              <!-- Teclado virtual -->
              <div class="mb-2">
                <button type="button"
                  class="flex items-center space-x-2 text-blue-600 hover:text-blue-700 transition-colors cursor-pointer"
                  (click)="handleShowKeyboard()">
                  <em class="fas fa-keyboard text-lg"></em>
                  <span class="text-sm font-medium underline">Teclado Virtual</span>
                </button>
                <div class="mt-2" *ngIf="isVisibleKeyboard">
                  <app-virtual-path (onKeyChange)="handleKeyChange($event)"></app-virtual-path>
                </div>
              </div>
              <div class="mb-2">

                <mat-card *ngIf="(changePassword.newPassword?.length || changePassword.confirmPassword?.length)"
                  [ngClass]="{
                    'error-card': passwordStatus === 'mal',
                    'warn-card': passwordStatus === 'debil',
                    'info-card': passwordStatus === 'normal',
                    'success-card': passwordStatus === 'muybien'
                  }" class="mt-4 mx-auto max-w-sm shadow-md rounded-xl">

                  <mat-card-content class="flex items-center gap-2 p-3">

                    <mat-icon *ngIf="passwordStatus === 'mal'" color="warn"
                      class="text-lg align-middle">error</mat-icon>
                    <mat-icon *ngIf="passwordStatus === 'debil'" color="accent"
                      class="text-lg align-middle">warning</mat-icon>
                    <mat-icon *ngIf="passwordStatus === 'normal'" color="primary"
                      class="text-lg align-middle">info</mat-icon>
                    <mat-icon *ngIf="passwordStatus === 'muybien'" color="primary"
                      class="text-lg align-middle">check_circle</mat-icon>
                    <span class="font-medium text-base align-middle">
                      {{ passwordMessage }}
                    </span>
                  </mat-card-content>
                </mat-card>
              </div>

              <div class="space-y-2">

                <button type="button" class="w-full py-2 rounded-md mb-6 transition-colors font-semibold"
                  [disabled]="!isPasswordValid" [ngClass]="{
                  'bg-[#153F7B] hover:bg-[#153F7B] cursor-pointer text-white rounded-lg mb-2': isPasswordValid,
                  'bg-[#DDDFE5] cursor-not-allowed text-gray-500 rounded-lg mb-2': !isPasswordValid
                }" (click)="f.valid && handleChangePassword()">
                  Aceptar
                </button>

                <div class="text-center">
                  <a href="#"
                    class="text-blue-600 hover:text-blue-700 hover:underline text-sm font-medium transition-colors">
                    CANCELAR
                  </a>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Footer al final -->
  <div class="flex-shrink-0 lg:flex-shrink-0 mt-auto lg:mt-1.5">
    <app-footer></app-footer>
  </div>
</div>
