<div class="row">
    <div class="col-md-12">
        <app-bar-route></app-bar-route>
        <h4 class="historical__h4">Instrucciones de configuración y tipo de carga</h4>
        <div class="row helpers__hidden-small">
            <div class="col-md-12">
                <div class="bar-route"></div>
                <div class="alert alert-information">
                    <div class="row">
                        <div class="col-md-6">
                            <p>
                                1. En carga de planilla manual, se cargaran los pagos que tiene configurados para su
                                empresa.
                            </p>
                        </div>
                        <div class="col-md-6">
                            <p>
                                2. Para importar un archivo, nuevo debe asegurarse que los codigos de los pagos no se
                                repitan, y no debe modificar la estructura y el contenido del archivo autogenerado.
                            </p>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <p>
                                3. Si la empresa, aun no proceso correctamente la configuración anterior uste no podrá
                                generar una nueva configuración.
                            </p>
                        </div>
                        <div class="col-md-6">
                            <p>
                                4. Para generar una nueva configuracion, debe modificar al menos uno de sus pagos
                                configurados.
                            </p>
                        </div>
                    </div>
                    <div class="row">
                            <div class="col-md-6">
                                <p>
                                    5. Los códigos de los pagos no deben repetirse y no se permite ingresar
                                    caracteres extraños.
                                </p>
                            </div>
                            <div class="col-md-6">
                                <p>
                                    6. Puede utilizar el boton "Cambiar glosas masivamente", para actualizar todas
                                    las glosas de la planilla.
                                </p>
                            </div>
                        </div>
                </div>
            </div>
        </div>
        <app-button-group (onChange)="handleGroupChanged($event)">
            <app-button-group-content [active]="true" [contentTitle]="'Cargar planilla  manual'">
            </app-button-group-content>
            <app-button-group-content [disabled]="isTransactionSuccessful" [contentTitle]="'Importar Archivo'">
                <app-import-files [disabled]="isTransactionSuccessful" (action)="handleLoadFile($event)"
                    [operationType]="batchInformation.operationTypeId"></app-import-files>
            </app-button-group-content>
        </app-button-group>
        <div class="row">
            <div class="col-md-12">
                <app-bar-route></app-bar-route>
                <h4 class="historical__h4">Seleccione Pago</h4>
                <div class="row haberes__destination-info">
                    <div class="col-md-12">
                        <div class="row card-info helpers__hidden-small">
                            <div class="col-md-3">
                                <p class="text-big {{spreadsheetSizeHab > 0 ? 'text--green' : 'text--red'}}">
                                    {{spreadsheetSizeHab}}</p>
                                <strong>
                                    <p class="text-small text--red">Cantidad de pagos de Haberes</p>
                                </strong>
                            </div>
                            <div class="col-md-3">
                                <p class="text-big {{spreadsheetSizeProv > 0 ? 'text--green' : 'text--red'}}">
                                    {{spreadsheetSizeProv}}</p>
                                <strong>
                                    <p class="text-small text--red">Cantidad de pagos a Proveedores</p>
                                </strong>
                            </div>
                            <div class="col-md-3">
                                <p class="text-big {{spreadsheetSizeEfe > 0 ? 'text--green' : 'text--red'}}">
                                    {{spreadsheetSizeEfe}}</p>
                                <strong>
                                    <p class="text-small text--red">Cantidad de pagos en Efectivo</p>
                                </strong>
                            </div>
                            <div class="col-md-3">
                                <p class="text-big {{spreadsheetSizeAch > 0 ? 'text--green' : 'text--red'}}">
                                    {{spreadsheetSizeAch}}</p>
                                <strong>
                                    <p class="text-small text--red">Cantidad de pagos ACH</p>
                                </strong>
                            </div>
                        </div>
                    </div>
                </div>
                <br>
                <app-button-group>
                    <app-button-group-content [active]="true" [disabled]="isTransactionSuccessful"
                        [contentTitle]="'Pago de Haberes'">
                        <app-salaries [disabled]="isTransactionSuccessful" [visible]="isVisibleHab"
                            (onRowChange)="handleRowChanged()" [batchInformation]="batchInformation"
                            [spreadsheetPerPage]="spreadsheetPerPageHab"></app-salaries>
                        <fieldset [disabled]="isTransactionSuccessful"><legend></legend><br>
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="col-md-8">
                                        <app-pagination *ngIf="isVisibleHab" [rowsPerPage]="rowsPerPageHab"
                                            [isCenter]="false" [totalItems]="spreadsheetSizeHab"
                                            [maxSize]="itemsPerPageHab" (onChange)="handlePageChangedHab($event)"
                                            (onChangeRowsPerPage)="handleViewRowsHab($event)"></app-pagination>
                                    </div>
                                    <br>
                                    <div class="offset-md-1 col-md-3 col-sm-12 top-space" *ngIf="!haveErrorsHab">
                                        <button *ngIf="isVisibleHab"
                                            class="button__secondary historical__button-secondary"
                                            (click)="showGlossForm=true; glossType='HAB';">CAMBIAR
                                            GLOSAS MASIVAMENTE</button>
                                    </div>
                                </div>
                            </div>
                        </fieldset>
                    </app-button-group-content>
                    <app-button-group-content [disabled]="isTransactionSuccessful"
                        [contentTitle]="'Pago a Proveedores'">
                        <app-providers [disabled]="isTransactionSuccessful" [visible]="isVisibleProv"
                            (onRowChange)="handleRowChanged()" [batchInformation]="batchInformation"
                            [spreadsheetPerPage]="spreadsheetPerPageProv"></app-providers>
                        <fieldset [disabled]="isTransactionSuccessful"><legend></legend><br>
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="col-md-8">
                                        <app-pagination *ngIf="isVisibleProv" [rowsPerPage]="rowsPerPageProv"
                                            [isCenter]="false" [totalItems]="spreadsheetSizeProv"
                                            [maxSize]="itemsPerPageProv" (onChange)="handlePageChangedProv($event)"
                                            (onChangeRowsPerPage)="handleViewRowsProv($event)"></app-pagination>
                                    </div>
                                    <br>
                                    <div class="offset-md-1 col-md-3 col-sm-12 top-space" *ngIf="!haveErrorsProv">
                                        <button *ngIf="isVisibleProv"
                                            class="button__secondary historical__button-secondary"
                                            (click)="showGlossForm=true; glossType='PROV';">CAMBIAR
                                            GLOSAS MASIVAMENTE</button>
                                    </div>
                                </div>
                            </div>
                        </fieldset>
                    </app-button-group-content>
                    <app-button-group-content [disabled]="isTransactionSuccessful" [contentTitle]="'Pago en Efectivo'">
                        <app-cash [disabled]="isTransactionSuccessful" [visible]="isVisibleEfe"
                            (onRowChange)="handleRowChanged()" [batchInformation]="batchInformation"
                            [spreadsheetPerPage]="spreadsheetPerPageEfe"></app-cash>
                        <fieldset [disabled]="isTransactionSuccessful"><legend></legend><br>
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="col-md-8">
                                        <app-pagination *ngIf="isVisibleEfe" [rowsPerPage]="rowsPerPageEfe"
                                            [isCenter]="false" [totalItems]="spreadsheetSizeEfe"
                                            [maxSize]="itemsPerPageEfe" (onChange)="handlePageChangedEfe($event)"
                                            (onChangeRowsPerPage)="handleViewRowsEfe($event)"></app-pagination>
                                    </div>
                                </div>
                            </div>
                        </fieldset>
                    </app-button-group-content>
                    <app-button-group-content [disabled]="isTransactionSuccessful" [contentTitle]="'Pago ACH'">
                        <app-ach [disabled]="isTransactionSuccessful" [visible]="isVisibleAch"
                            (onRowChange)="handleRowChanged()" [batchInformation]="batchInformation"
                            [spreadsheetPerPage]="spreadsheetPerPageAch"></app-ach>
                        <fieldset [disabled]="isTransactionSuccessful"><legend></legend><br>
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="col-md-8">
                                        <app-pagination *ngIf="isVisibleAch" [rowsPerPage]="rowsPerPageAch"
                                            [isCenter]="false" [totalItems]="spreadsheetSizeAch"
                                            [maxSize]="itemsPerPageAch" (onChange)="handlePageChangedAch($event)"
                                            (onChangeRowsPerPage)="handleViewRowsAch($event)"></app-pagination>
                                    </div>
                                </div>
                            </div>
                        </fieldset>
                    </app-button-group-content>
                </app-button-group>
            </div>
        </div>
        <br>
        <app-information-panel [visible]="validateAmount" [message]="'El monto debe ser mayor a 0.'"
            [type]="'attention'"></app-information-panel>
    </div>
</div>
<app-approvers-and-controllers [disabled]="isTransactionSuccessful" [approversRequest]="authorizersDto"
    [currency]="batchInformation.currency" (onChange)="handleApproversOrControllersChanged($event)"
    [isAdministrative]="true" #approversAndControllers></app-approvers-and-controllers>
<app-information-panel [visible]="isTransactionSuccessful"
    [message]="successfulTransactionMessage + ' ' + processBatchNumber"></app-information-panel>
<app-information-panel [visible]="!isValidToCreateBatch"
    [message]="'La compañia tiene configuraciones anteriores, pendientes de procesar no podrá generar la solicitud'"
    [type]="'attention'"></app-information-panel>
<app-information-panel [visible]="!existsChanges" [message]="'No se realizaron cambios en la planilla'"
    [type]="'attention'"></app-information-panel>
<div class="row transferencia-ext__submit">
    <div class="col-md-3">
        <button class="button__principal historical__button-secondary"
            [disabled]="isTransactionSuccessful || !isValidToCreateBatch || !existsChanges"
            (click)="handleValidate(approversAndControllers.handleValidate())">
            PREPARAR TRANSACCIÓN
        </button>
    </div>
    <div class="col-md-2 col-sm-12">
        <p class="historical__p--cancel" *ngIf="!isTransactionSuccessful"><a [routerLink]="['']">CANCELAR</a></p>
        <p class="historical__p--cancel" *ngIf="isTransactionSuccessful"><a
                [routerLink]="['/queries/pendings']">PROCESAR
                OPERACIÓN</a></p>
    </div>
</div>
<app-token-modal [isVisible]="showTokenForm" (onSubmit)="handleTokenSubmit($event)" (onClose)="showTokenForm=false"
    [message]="'Necesitamos que ingrese su número Token para confirmar la transferencia.'"></app-token-modal>
<app-modal [visible]="excedeedAmount" (onClose)="excedeedAmount=false" [size]="'md'">
    <div class="app-modal-header col-md-12 col-sm-12">Saldo insuficiente </div>
    <div class="app-modal-body col-md-12 col-sm-12">Estimado cliente, su operación será rechazada si no cuenta con fondos suficientes al
        momento de realizar la autorización.</div>
    <div class="app-modal-footer col-md-12 col-sm-12">
        <div class="offset-md-3 col-md-6 col-xs-12">
            <button class="button__principal modal__button" (click)="excedeedAmount=false; showToken()">Aceptar</button>
        </div>
    </div>
</app-modal>
<app-modal [visible]="showGlossForm" (onClose)="showGlossForm=false" [size]="'md'">
    <div class="app-modal-header col-md-12 col-sm-12">Cambiar glosa masivamente</div>
    <div class="app-modal-body col-md-12 col-sm-12">
        <div class="row haberes__modal__inputs">
            <div class="col-md-12 inputs ">
                <form name="globalGlossForm" #globalGlossForm="ngForm" novalidate autocomplete="off">
                    <div class="input-numero">
                        <label>Glosa</label>
                        <input type="text" name="gloss" [(ngModel)]="globalGloss" required
                            appValidate="alphanumericBasicSymbols" appOnlyType="alphanumericBasicSymbols" maxlength="30"
                            #gloss="ngModel">
                        <app-show-errors [control]="gloss"></app-show-errors>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <div class="app-modal-footer col-md-12 col-sm-12">
        <div class="row modal__container-button">
            <div class="offset-md-4 col-md-4 col-xs-12">
                <button class="button__principal modal__button" (click)="handleAssignGlobalGloss()"><em
                        class="fas fa-plus-circle"></em>
                    AGREGAR</button>
            </div>
        </div>
        <div class="row modal__cancelar">
            <div class="col-md-12 col-xs-12"><a (click)="showGlossForm=false;globalGloss='';" class="link-cancel-modal">CANCELAR</a></div>
        </div>
    </div>
</app-modal>