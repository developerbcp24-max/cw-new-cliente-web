<app-source-accounts [accountRequest]="accountRequest" [disabled]="isDisabledForm"
  (onChange)="handleSourceAccountChanged($event)" #sourceAccount></app-source-accounts>
<div class="row  historical__period">
  <div class="col-md-12">
    <app-bar-route></app-bar-route>
    <div class="transferencias__container-title-detail">
      <p class="historical__p--cancel transferencia-ext__p-link helpers__hidden-small" (click)="showCompanyLimits=true">
        <a>Ver límite diario</a></p>
    </div>
    <h4 class="historical__h4">Selecciona tipo de servicio</h4>
    <div class="row historical__period-options">
      <div class="col-md-12">
        <app-button-group (onChange)="handleGroupChanged($event)">
          <app-button-group-content [disabled]="isDisabledForm" [contentTitle]="'CRE'">
            <app-client-code [disabled]="isDisabledForm" [service]="getDebtRequest.service"
              (onFavoriteChanged)="handleSaveFavoriteChanged($event)" (onChange)="handleGetDebtChanged($event)"
              (onCheckedChange)="handleFavoritePaymentCheckChanged($event)" (onNewSearch)="handleOnNewSearch()"
              #creClientCode></app-client-code>
          </app-button-group-content>
          <app-button-group-content [disabled]="isDisabledForm" [contentTitle]="'DELAPAZ'" *ngIf="swServicePase[0]">
              <app-payment-type [disabled]="isDisabledForm" [typeService]="typeService" [isDelapaz]="isDelapaz"
            [listCriteria]="servicesResult" (onChange)="handleGetDebtChanged($event)"
            (onChangeDebts)=handleGetDebtsDto($event); (onFavoriteChanged)="handleSaveFavoriteChanged($event)" #paymentType></app-payment-type>

          </app-button-group-content>
          <app-button-group-content [disabled]="isDisabledForm" [contentTitle]="'ELFEC'" *ngIf="swServicePase[1]">
            <app-invoice-code [disabled]="isDisabledForm" [detail]="detailElfec"
              (onChange)="handleGetDebtChanged($event)" (onFavoriteChanged)="handleSaveFavoriteChanged($event)"
              (onChangeElfecDto)="handleElfecDto($event)" (onNewSearch)="handleOnNewSearch()"></app-invoice-code>
          </app-button-group-content>
        </app-button-group>
      </div>
    </div>
  </div>
</div>
<app-debt-detail *ngIf="typeOperation == 0 || typeOperation == 1" [disabled]="isDisabledForm"
  [creSaguapacDebt]="creSaguapacDebt" [paseDebt]="delapazDebt" [service]="getDebtRequest.service"
  (onChange)="handleDebtDetailChanged($event)"></app-debt-detail>

<app-debt-elfec *ngIf="typeOperation == 2" [disabled]="isDisabledForm" [detailElfec]="detailElfec"
  (onChange)="handleDebtDetailChanged($event)"></app-debt-elfec>

<app-send-bill [disabled]="isDisabledForm" [visible]="creSaguapacDebt!=undefined"
  (onChange)="handleSendBillChanged($event)" #sendBill></app-send-bill>
<app-approvers-and-controllers [approversRequest]="approversDto" [currency]="paymentInformation.currency"
  [amount]="paymentInformation.amount" [disabled]="isDisabledForm"
  (onChange)="handleApproversAndControllersChanged($event)" #approversAndControllers></app-approvers-and-controllers>
<app-emails-input [disabled]="isDisabledForm" [batchInformation]="paymentInformation" #emails></app-emails-input>

<app-successful-operation-modal [processBatchId]="processBatchNumber" [isSuccessful]="isDisabledForm"
  [operationTypeId]="paymentInformation.operationTypeId" [operationTypeName]="paymentInformation.operationTypeName">
</app-successful-operation-modal>

<div class="row transferencia-ext__submit">
  <div class="col-md-3 col-sm-4">
    <button class="button__principal historical__button-secondary" [disabled]="isPaymentSuccessful"
      (click)="handleValidate(sendBill.handleValidate()!, approversAndControllers.handleValidate(), approversAndControllers.validateApproversLimit(),sourceAccount.handleValidate()!,emails.handleValidate()!,false)">
      PREPARAR TRANSACCIÓN
    </button>
  </div>
  <div class="col-md-3" *ngIf="is_validbatchtoken">
    <button class="button__pre_save historical__button-secondary" [disabled]="isPaymentSuccessful"
      (click)="handleValidate(sendBill.handleValidate()!, approversAndControllers.handleValidate(), approversAndControllers.validateApproversLimit(),sourceAccount.handleValidate()!,emails.handleValidate()!,true)">
      ENVIAR A PREPARACIÓN MASIVA
    </button>
  </div>
  <div class="col-md-2 col-sm-4" *ngIf="getDebtRequest.service === '3' || getDebtRequest.service === '4'">
    <button class="button__secondary historical__button-secondary button-program"
      (click)="handleValidateForScheduleOperation(approversAndControllers.handleValidate(), approversAndControllers.validateApproversLimit(),sourceAccount.handleValidate()!)"
      [disabled]="isPaymentSuccessful"><em class="fas fa-calendar-alt"></em> PROGRAMAR
    </button>
  </div>
  <div class="col-md-3 col-sm-4">
    <p class="historical__p--cancel" *ngIf="!isPaymentSuccessful"><a [routerLink]="['']">CANCELAR</a></p>
    <p class="historical__p--cancel" *ngIf="isPaymentSuccessful"><a
        [routerLink]="['/service-payments/electricity']">NUEVO</a></p>
  </div>
</div>
<app-date-future [visible]="scheduleOperation" (onClose)="scheduleOperation=false"
  (onChange)="handleDateFuture($event)"></app-date-future>
<app-token-modal [disabled]="isTokenFormDisabled" [isVisible]="isVisibleToken" (onSubmit)="handleTokenSubmit($event)"
  (onClose)="isVisibleToken=false"></app-token-modal>
<app-modal [visible]="excedeedAmount" (onClose)="excedeedAmount=false" [size]="'md'">
  <div class="app-modal-header col-md-12 col-sm-12">Saldo insuficiente </div>
  <div class="app-modal-body col-md-12 col-sm-12">Estimado cliente, su operación será rechazada si no cuenta con fondos suficientes al
    momento de realizar la autorización.</div>
  <div class="app-modal-footer col-md-12 col-sm-12"><button type="button" class="button__principal modal__button"
      (click)="excedeedAmount=false; showToken();">Aceptar</button></div>
</app-modal>
<app-company-limits [isVisible]="showCompanyLimits" (onClose)="showCompanyLimits=false"></app-company-limits>

<app-pre-preparer-modal [isPreSave]="isPreSave" (prePreparer)="handleIsPreparer($event);"></app-pre-preparer-modal>
