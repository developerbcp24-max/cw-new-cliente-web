<div class="col-md-12">
    <app-bar-route></app-bar-route>
    <h4 class="historical__h4">Titular de la Cuenta</h4>
    <div class="row">
      <div class="col-sm-6">
        <div class="alert alert-information">
          <p>{{titularUser.company_name}} </p>
        </div>
      </div>
    </div>
  </div>
  
  <div class="col-md-12">
    <app-bar-route [isLast]="true"></app-bar-route>
    <h4 class="historical__h4">Selecciona un periodo de consulta</h4>
    <div class="row historical__period-options">
      <div class="col-sm-8">
        <app-button-group (onChange)="handleGroupChanged($event)">
          <app-button-group-content [contentTitle]="'Por Fechas'">
                <app-date-range [(ngModel)]="dateRange" [options]="optionsDateRange" class="col-md-12" *ngIf="isDateOrMonths">
                </app-date-range>
          </app-button-group-content>
          <app-button-group-content [contentTitle]="'Por Mes'">
            <app-select-month (onChangeFilter)="handleGetMonths($event)" *ngIf="!isDateOrMonths"></app-select-month>
          </app-button-group-content>
        </app-button-group>
      </div>
    </div>
  </div>
  
  <div class="row haberes__submit">
    <div class="col-md-3">
      <button class="button__secondary" (click)="SearchBill()" [disabled]="!isDisabled"><em class="icon-Lupa"></em>
        BUSCAR</button>
    </div>
  </div><br>
  
  <div class="row" *ngIf="isVisibleDetail">
    <div class="col-md-12">
      <div class="row historical__options-table">
        <div class="col-md-3 col-sm-12">
          <p class="historical__p">Total Facturas Encontradas: {{totalBills}}</p>
        </div>
  
        <div class="offset-md-2 col-md-5 historical__button--align">
          <div *ngIf="isDateOrMonths">
            <p class="historical__p">Formato para exportar</p>
            <select class="input-simple historical__input-table" name="reportType" [(ngModel)]="requestHeader.reportType">
              <option [ngValue]="true">PDF</option>
              <option [ngValue]="false">EXCEL</option>
            </select>
          </div>
          <p *ngIf="!isDateOrMonths && totalBills <= 200" class="historical__p">Descargar todas las facturas en formato ZIP
          </p>
        </div>
        <div class="col-md-2  col-sm-6 historical__button--align">
          <button *ngIf="isDateOrMonths" class="button__secondary historical__button-secondary"
            (click)="handleExportListBill()"><em class="fa fa-download"></em> EXPORTAR</button>
          <button *ngIf="!isDateOrMonths && totalBills <= 200" class="button__secondary historical__button-secondary"
            (click)="handleDonwloadRarDetail()"><em class="fa fa-download"></em> DESCARGAR</button>
        </div>
      </div>
  
      <div class="table-responsive">
        <table class="cw-table table-striped"><caption></caption>
          <thead>
            <tr>
              <th>Fecha</th>
              <th>CUF</th>
              <th>Importe Bs.</th>
              <th>Ver Detalle</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let detail of responseHeader">
              <td>{{detail.dateBill| date:'medium' }}</td>
              <td>{{detail.code}}</td>
              <td>{{detail.amount| number: '1.2-2'}}</td>
              <td>
                <a (click)="handleShowDetails(detail.number, detail.code, detail.authorizationNumber)"><em
                    class="fa fa-arrow-circle-down button__size"></em></a>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <app-pagination [rowsPerPage]="rowsPerPage" [isCenter]="true" [totalItems]="totalBills" [maxSize]="pageItems"
        (onChange)="handlePageChanged($event)" (onChangeRowsPerPage)="handleViewRows($event)"></app-pagination>
    </div>
  </div>
  
  <ng-container class="row" *ngIf="isPanelVisible">
    <app-information-panel [message]="message" [type]="'attention'"></app-information-panel>
  </ng-container>
  
  <app-modal [visible]="isModalVisible" (onClose)="isModalVisible=false" [size]="'sm'">
    <div class="app-modal-header col-md-12 col-sm-12">
      <strong>Información</strong>
    </div>
    <div class="app-modal-body col-md-12 col-sm-12">
      La cantidad facturas encontradas ({{totalBills}}) excede el monto permitido de (200), no podrá generar el archivo
      RAR
    </div>
    <div class="app-modal-footer col-md-12 col-sm-12">
      <button type="button" class="btn btn-primary" (click)="isModalVisible=false">Aceptar</button>
    </div>
  </app-modal>