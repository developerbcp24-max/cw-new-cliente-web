<div class="container">
  <div class="row">
    <div class="col-md-12">
      <div class="col-md-12">
        <h3 class="mb-4"><strong>Formulario de registro</strong></h3>
      </div>
      <div class="historical__box historical__account-box">
        <form name="currencyForm" novalidate #currencyForm="ngForm" autocomplete="off">
          <fieldset [disabled]="false"><legend></legend><br>
            <div class="form-group">
              <legend> <h3>CAJAS</h3></legend><br>
              <div class="account-flag">
                <h4>Favor de asignar los usuarios "cajeros" a la Sucursal y Caja correspondiente.</h4>
              </div>
            </div>
          </fieldset>
        </form>
        <div class="col-md-12">
          <div class="row transferencia-ext__submit">
            <br>
            <div class="col-md-4"> <br>
              <button [disabled]="registrarCaja" class="button__principal historical__button-secondary btn-lg" (click)="handleAddRow()">
                REGISTRAR CAJA <em class="fas fa-plus-circle"></em>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="w-full">
  <div class="w-full">
    <fieldset [disabled]="disabled"><legend></legend><br>
      <app-list-atm [visible]="visible" [cajaNewList]="cajaNewList" [spreadsheetSize]="spreadsheetSize"
        [disabled]="disabled" [businessId]="businesId" [listAtmQR]="listAtmQR"></app-list-atm>
      <app-modal [visible]="showDetailForm" (onClose)="showDetailForm=false" [size]="'md'" [manualCloseModal]="true">
        <div class="app-modal-header col-md-12 col-sm-12">{{operation === 1 ? 'Editar Caja' : 'Crear Caja'}}
        </div>
        <div class="app-modal-body col-md-12 col-sm-12">
          <form name="cajaForm" #cajaForm="ngForm" novalidate autocomplete="off">
            <div class="form-group">
              <div class="account-flag">
                <label for="nombre">Cuenta Origen:</label>
                <app-my-accounts class="historical__select-account input-simple helpers__select-modal" [ngClass]="{'transferencias__select-account':!showDetails, 'select-account':showDetails}"
                [loadFirstAccount]="loadFirstAccount" [accountRequest]="accountDto" [companyAccounts]="companyAccounts"
                    [returnBalances]="showBalances" [selectedAccount]="selectedAccountId" [isAwait]="isAwait" [onlyCurrencyBOL]="onlyCurrencyBOL"
                    (onChange)="handleAccountChanged($event)" [defaultAccount]="defaultAccount"
                ></app-my-accounts>
              </div>
            </div>
            <div class="form-group">
              <label for="nombre">Nombre caja:</label>
              <input type="text" class="historical__select-account form-control helpers__select-modal" name="atmName"
                [(ngModel)]="detail.atmName" #atmName="ngModel" required appOnlyType="alphanumericBasicSymbols"
                appValidate="alphanumericBasicSymbols" maxlength="35" placeholder="Ej: Caja 1" required>
              <app-show-errors [control]="atmName"></app-show-errors>
            </div>

            <div class="form-group">
              <label for="branchName">Seleccione Sucursal:</label>
              <select id="branchName" name="branchCode"
                class="historical__select-account input-simple helpers__select-modal" #branchCode
                [(ngModel)]="detail.branchCode" (ngModelChange)="selectBranchQr(newListBranchQR)"required>
                <option value="0">Seleccione un sucursal</option>
                <option *ngFor="let sucursal of newListBranchQR" [value]="sucursal.branchCode"> {{sucursal.branchName}}
                </option>
              </select>
              <app-show-errors [control]="branchCode"></app-show-errors>
            </div>

            <div class="form-group">
              <label for="userId">Asignar Cajero:</label>
              <select id="qrUserId" name="qrUserId"
                class="historical__select-account input-simple helpers__select-modal" #qrUserId
                [(ngModel)]="detail.qrUserId" (ngModelChange)="selectUserhQr(newUserAtmlist)" required>
                <option value="0">Seleccione un usuario</option>
                <option *ngFor="let user of newUserAtmlist" [value]="user.qrUserId">{{user.name}}</option>
              </select>
              <app-show-errors [control]="qrUserId"></app-show-errors>
            </div>
          </form>
        </div>
        <div class="app-modal-footer col-md-12 col-md-12">
            <div class="row modal__container-button justify-content-center">
              <div class="col-md-4 col-xs-12 d-flex justify-content-center">
                <button class="button__principal modal__button" (click)="handleValidate()"
                #closeApp>{{operation===1?'ACEPTAR':'GUARDAR'}}</button>
              </div>
            </div>
            <div class="row modal__cancelar justify-content-center text-center">
            <div class="col-md-12 col-xs-12">
              <a (click)="handleCancel()" class="link-cancel-modal">CANCELAR</a>
            </div>
            </div>
        </div>
      </app-modal>
    </fieldset>
  </div>
</div>

<div class="row">
  <div class="col-md-12 offset-md-8">
    <div class="row transferencia-ext__submit"><br>
      <div class="col-md-2 col-sm-12">
        <input type="button" class="button__principal button-next" (click)="handleShowToken()"
          [disabled]="isDisabledForm" value="FINALIZAR">
      </div>
    </div>
  </div>
</div>
